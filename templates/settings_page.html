{% extends 'base.html' %} {# This line tells Flask/Jinja2 to use your base.html as the layout foundation #}

{% block title %}Settings - Arcade Manager{% endblock %} {# Sets the title for this specific page #}

{% block content %} {# This block will contain the unique content for the Settings page #}
    <div class="content-header">
        <div class="content-header-left">
            <h2>App Settings</h2>
            <p>Manage application preferences and reset options here.</p>
        </div>
    </div>

    {# --- NEW CODE HERE --- #}
    {# Main "Reset Options" collapsible section #}
    <section class="section-card collapsible-section">
        <div class="collapsible-header" id="resetOptionsToggle">
            <h3>Reset Options</h3>
            <i class="fas fa-chevron-down toggle-icon"></i>
        </div>
        <div class="collapsible-content">
            {# Sub "Main Dashboard" collapsible section #}
            <div class="collapsible-section nested-section">
                <div class="collapsible-header" id="mainDashboardResetToggle">
                    <h4>Main Dashboard</h4>
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
                <div class="collapsible-content">
                    {# Button for Reset Opening Checklist Status #}
                    <button id="resetOpeningChecklistBtn" class="reset-button">
                        <i class="fas fa-undo"></i> Reset Opening Checklist Status
                    </button>
                    <p class="reset-description">This will un-gray the "Start Opening Checklist" card on the Dashboard.</p>
                </div>
            </div>
            {# Other reset categories can go here later, e.g.:
            <div class="collapsible-section nested-section">
                <div class="collapsible-header" id="inventoryResetToggle">
                    <h4>Inventory</h4>
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
                <div class="collapsible-content">
                    <button class="reset-button"><i class="fas fa-trash"></i> Clear All Inventory</button>
                </div>
            </div>
            #}
        </div>
    </section>
    {# --- END NEW CODE --- #}

    <section class="section-card" style="margin-top: 2rem;">
        <h3>General Settings</h3>
        <p>This section will contain other application-wide settings.</p>
        {# Future settings like notification preferences, etc., will go here #}
    </section>

    {# --- NEW CODE HERE --- #}
    {# Custom styles for the collapsible sections and reset button #}
    <style>
        .collapsible-section {
            margin-bottom: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            overflow: hidden; /* Ensures content doesn't spill out when collapsed */
        }

        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background-color: #f8fafc;
            cursor: pointer;
            border-bottom: 1px solid #e2e8f0;
            transition: background-color 0.2s ease-in-out;
        }

        .collapsible-header:hover {
            background-color: #f0f4f8;
        }

        .collapsible-header h3, .collapsible-header h4 {
            margin: 0;
            font-size: 1.25rem;
            color: #1f2937;
        }

        .collapsible-header .toggle-icon {
            transition: transform 0.3s ease-in-out;
        }

        .collapsible-header.active .toggle-icon {
            transform: rotate(180deg); /* Rotates the arrow when active */
        }

        .collapsible-content {
            max-height: 0; /* Initially hidden */
            overflow: hidden;
            transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out;
            padding: 0 1.5rem; /* No padding when collapsed */
        }

        .collapsible-content.active {
            max-height: 500px; /* Arbitrary large value to allow content to expand */
            padding: 1.5rem; /* Apply padding when active */
        }

        .nested-section .collapsible-header {
            background-color: #ffffff; /* Lighter background for nested header */
            border-bottom: none; /* No border for nested header */
            padding: 0.75rem 1rem; /* Smaller padding for nested header */
        }

        .nested-section .collapsible-header h4 {
            font-size: 1.1rem;
        }

        .nested-section .collapsible-content {
            padding: 0 1rem; /* Smaller padding for nested content */
        }

        .nested-section .collapsible-content.active {
            padding: 1rem;
        }

        .reset-button {
            background-color: #dc3545; /* Red for reset actions */
            color: white;
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem; /* Space from header */
        }

        .reset-button:hover {
            background-color: #c82333;
            transform: translateY(-1px);
        }

        .reset-button:active {
            transform: translateY(0);
        }

        .reset-description {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 0.5rem;
        }
    </style>

    {# JavaScript for handling collapsible sections #}
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            function setupCollapsible(headerId, contentClass) {
                const header = document.getElementById(headerId);
                if (header) {
                    // Find the content div immediately following the header
                    const content = header.nextElementSibling; 
                    if (content && content.classList.contains(contentClass)) {
                        header.addEventListener('click', () => {
                            header.classList.toggle('active');
                            content.classList.toggle('active');
                        });
                    } else {
                        console.warn(`Collapsible setup: Content element with class '${contentClass}' not found after header '${headerId}'.`);
                    }
                } else {
                    console.warn(`Collapsible setup: Header element with ID '${headerId}' not found.`);
                }
            }

            // Setup main "Reset Options" collapsible
            setupCollapsible('resetOptionsToggle', 'collapsible-content');
            // Setup nested "Main Dashboard" collapsible
            setupCollapsible('mainDashboardResetToggle', 'collapsible-content');
        });
    </script>
    {# --- END NEW CODE --- #}
{% endblock content %}
