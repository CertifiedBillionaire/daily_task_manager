{% extends 'base.html' %} {# This line tells Flask/Jinja2 to use your base.html as the layout foundation #}

{% block title %}TPT Calculator - Arcade Manager{% endblock %} {# Sets the unique title for this page #}

{% block content %} {# This block will contain all the unique content for the TPT Calculator page #}
    <div class="content-header">
        <div class="content-header-left">
            <h2>TPT Calculator</h2>
            <p>Upload your TPT data file here.</p>
        </div>
    </div>

    <section class="section-card">
        <div class="tpt-upload-and-settings-header">
            <div class="tpt-upload-elements">
                <h3>Upload TPT Data File</h3>
                <div class="form-group">
                    <label for="tptFileInput">Select File (.csv, .xlsx):</label>
                    <input type="file" id="tptFileInput" accept=".csv, .xlsx">
                </div>
            </div>
            <div class="tpt-settings-toggle-area">
                <button class="icon-button" id="toggleTptSettingsBtn" title="Toggle TPT Settings">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>

        <div id="tptSettingsContainer" class="tpt-settings-container collapsed">
            <div class="tpt-settings-inputs">
                <label for="tptLowest">Lowest Desired TPT:</label>
                <input type="number" id="tptLowest" value="2.80" step="0.01">

                <label for="tptHighest">Highest Desired TPT:</label>
                <input type="number" id="tptHighest" value="3.20" step="0.01">

                <label for="tptTarget">Target TPT:</label>
                <input type="number" id="tptTarget" value="3.00" step="0.01">

                <div class="form-group-checkbox">
                    <input type="checkbox" id="includeBirthdayBlaster" checked>
                    <label for="includeBirthdayBlaster">Include Birthday Blaster in TPT calculation</label>
                </div>
            </div>
            <button class="add-task-button" id="saveTptSettingsBtn">Save Settings</button>
        </div>

        <button id="calculateTptButton" class="add-task-button">Calculate TPT</button>

        <div id="tptResults" style="margin-top: 30px; padding: 20px; background-color: #f8f8f8; border-radius: 10px; border: 1px solid #e0e0e0; display: none;">
            <h4>Calculation Results:</h4>
            <p id="tptOutput">Results will appear here.</p>
            <div id="outOfRangeGamesList" style="margin-top: 15px;">
            </div>
        </div>
        
        <div id="individualGameTableSection" class="section-card" style="margin-top: 30px; display: none;">
            <h2>Individual Game Data</h2>
            <div class="table-container">
                <table class="game-data-table">
                    <thead>
                        <tr>
                            <th>Profile</th>
                            <th>Game Name</th>
                            <th>TPT (Individual)</th>
                            <th>Total Tickets</th>
                            <th>Total Plays</th>
                        </tr>
                    </thead>
                    <tbody id="individualGameTableBody">
                    </tbody>
                </table>
            </div>
            <button id="exportIndividualGamesCsvBtn" class="add-task-button" style="margin-top: 20px;">Export Individual Games CSV</button>
        </div>
        
    </section>

    {# The script for TPT Calculator functionality should ideally be in static/js/modules/tptCalculator.js
       and linked in base.html if it's used across pages, or here if strictly for this page.
       For now, assuming it will be loaded via app.js or another module.
    #}
    {# <script src="{{ url_for('static', filename='js/tptCalculator.js') }}"></script> #}
{% endblock content %}

{# Any additional scripts that are *only* for this page and not already loaded by app.js or base.html
   would go in a custom block, if defined in base.html. Otherwise, they would be put directly here
   inside the content block as tags.
   Since your base.html includes app.js as type="module", ensure any page-specific JS
   is either integrated into app.js's module system or added as a separate script that runs after the DOM is ready.
   For simplicity, if tpt_calculator.js isn't already handled by app.js, you might add it here:
#}
{# <script src="{{ url_for('static', filename='js/modules/tptCalculator.js') }}"></script> #}
